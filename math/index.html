<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math Practice</title>

<style>
body{
 font-family:Arial;
 margin:12px;
 font-size:22px;
}

h2{text-align:center;}

.columns{
 display:grid;
 grid-template-columns:repeat(4,1fr);
 gap:12px;
}

@media(max-width:900px){
 .columns{
  grid-template-columns:repeat(2,1fr);
 }
}

.column{
 border:2px solid #ccc;
 border-radius:12px;
 padding:10px;
}

.timer{
 text-align:center;
 font-weight:bold;
 margin-bottom:10px;
}

.exercise{
 display:flex;
 justify-content:center;
 align-items:center;
 margin:6px 0;
}

.exercise span{
 width:32px;
 text-align:center;
}

.exercise input{
 width:70px;
 font-size:22px;
 text-align:center;
 margin-left:6px;
}

.correct{background:#b6f5b6;}
.wrong{background:#f7b1b1;}

#submitBtn{
 display:none;
 width:100%;
 padding:14px;
 font-size:22px;
 margin-top:20px;
 position:sticky;
 bottom:10px;
}

#codeBox{
 margin-top:20px;
 text-align:center;
 font-size:28px;
 font-weight:bold;
}
</style>
</head>

<body>

<h2>Math Practice</h2>

<div class="columns" id="worksheet"></div>
<button id="submitBtn" onclick="generateCode()">SUBMIT</button>
<div id="codeBox"></div>

<script>
const COLS=4;
const EX_PER_COL=28;
const worksheet=document.getElementById("worksheet");

let columnsFinished=0;

function formatTime(ms){
 const s=Math.floor(ms/1000);
 return String(Math.floor(s/60)).padStart(2,'0')+":"+
        String(s%60).padStart(2,'0');
}

function generateExercise(){
 const ops=["+","-","×","÷"];
 const op=ops[Math.floor(Math.random()*ops.length)];
 let a,b,r;

 if(op==="+"||op==="-" ){
  a=Math.floor(Math.random()*90)+10;
  b=Math.floor(Math.random()*90)+1;
  if(op==="-"&&b>a)[a,b]=[b,a];
  r=(op==="+")?a+b:a-b;
 }else{
  b=Math.floor(Math.random()*9)+1;
  a=Math.floor(Math.random()*9)+1;
  if(op==="÷") a*=b;
  r=(op==="×")?a*b:a/b;
 }
 return{a,b,op,r};
}

for(let c=0;c<COLS;c++){

 const col=document.createElement("div");
 col.className="column";

 col.innerHTML=
 "<h3>Column "+(c+1)+"</h3>"+
 "<div class='timer'>Time: 00:00</div>";

 const timerDiv=col.querySelector(".timer");

 let startTime=null;
 let interval=null;
 let finished=false;

 function startTimer(){
  if(startTime) return;
  startTime=Date.now();
  interval=setInterval(()=>{
   timerDiv.textContent="Time: "+
   formatTime(Date.now()-startTime);
  },500);
 }

 for(let i=0;i<EX_PER_COL;i++){

  const ex=generateExercise();
  let attempts=0;

  const row=document.createElement("div");
  row.className="exercise";

  row.innerHTML=
   "<span>"+ex.a+"</span>"+
   "<span>"+ex.op+"</span>"+
   "<span>"+ex.b+"</span>"+
   "<span>=</span>"+
   "<input type='number'>";

  const input=row.querySelector("input");

  input.addEventListener("input",()=>{

   startTimer();

   if(input.disabled)return;

   const val=Number(input.value);

   if(val===ex.r){
    input.className="correct";
    input.disabled=true;
   }else{
    attempts++;
    input.className="wrong";
    if(attempts>=6){
     input.disabled=true;
    }
   }

   const correctCount=
   col.querySelectorAll(".correct").length;

   if(correctCount===EX_PER_COL && !finished){

    finished=true;
    columnsFinished++;

    clearInterval(interval);

    timerDiv.textContent=
    "Finished: "+
    formatTime(Date.now()-startTime);

    if(c===0){
     document.getElementById("submitBtn").style.display="block";
    }
   }
  });

  col.appendChild(row);
 }

 worksheet.appendChild(col);
}

function generateCode(){

 const correctExercises=
 document.querySelectorAll(".correct").length;

 const today=new Date();

 const day=today.getDate();
 const month2=(today.getMonth()+1)*2;
 const correct2=correctExercises*2;

 const code=
 String(day)+
 String(month2).padStart(2,'0')+
 String(columnsFinished)+
 String(correct2);

 document.getElementById("codeBox").textContent=
 "RESULT CODE: "+code;
}
</script>

</body>
</html>
